# 20251110_ML01_DevLog.md - MicroLearn AI 개발 로그

**작성일:** 2025년 11월 10일
**작성자:** Gemini CLI Agent

## 1. 개요
본 개발 로그는 MicroLearn AI 프로젝트의 5회차 개발 보고서 이후부터 현재까지 진행된 작업 내용과 해결된 문제점들을 기록합니다. 초기 '자료와 대화하기' 기능 구현 후 백엔드 서버 구동 및 프론트엔드 컴파일 과정에서 발생한 다양한 에러들을 해결하고, 시연용 관리자 계정을 생성하는 데 집중했습니다.

## 2. 작업 내용 및 문제 해결 과정

### 2.1. 초기 백엔드 서버 구동 실패 및 API 키 문제
*   **문제 발생:** 'MicroLearn AI 개발 5회차 보고서'에 명시된 바와 같이, `GEMINI_API_KEY` 환경 변수 누락으로 백엔드 서버 시작 실패 및 프론트엔드 'Failed to fetch' 에러 발생.
*   **해결:** `.env` 파일에 `GEMINI_API_KEY`를 추가하도록 안내.

### 2.2. 프론트엔드 컴파일 에러 해결
*   **`MindMapDisplay.tsx` - 정규표현식 오류:**
    *   **원인:** `node.name.replace(/`와 같이 정규표현식이 닫히지 않아 `Unterminated regular expression` 에러 발생.
    *   **해결:** `node.name.replace(/"/g, '&quot;')`로 수정하여 큰따옴표를 HTML 엔티티로 치환하고 문법 에러 해결.
*   **`MindMapDisplay.tsx` - `export default` 누락:**
    *   **원인:** `MindMapDisplay.tsx`에 `MindMapDisplay` 컴포넌트의 정의 및 `export default` 구문 누락.
    *   **해결:** `MindMapDisplay` React 컴포넌트의 전체 코드와 `export default MindMapDisplay;` 구문 추가.
*   **`MainPage.tsx` - CSS 타입 에러:**
    *   **원인:** `getTabStyle` 함수 내 `all: 'unset'` 속성이 React의 `CSSProperties` 타입과 불일치하여 `TS2322` 에러 발생.
    *   **해결:** `all: 'unset'` 대신 `background: 'none'`, `border: 'none'`, `font: 'inherit'`과 같은 개별 CSS 속성으로 대체하여 타입 에러 해결.
*   **`ChatInterface.tsx` 및 `LearningNoteDetailPage.tsx` - 속성 이름 불일치:**
    *   **원인:** `ChatInterfaceProps`가 `noteId`를 기대하지만, `MaterialDetailPage.tsx`에서 `materialId`를 전달하여 `TS2322` 에러 발생.
    *   **해결:** `ChatInterfaceProps` 및 `ChatInterface` 컴포넌트 내부에서 `noteId`를 `materialId`로 통일하여 수정.
    *   이후 `LearningNoteDetailPage.tsx`에서도 `ChatInterface`에 전달하는 속성 이름을 `noteId`에서 `materialId`로 변경하여 해결.

### 2.3. 백엔드 `seed.py` 스크립트 및 로그인 관련 문제 해결
*   **관리자 계정 생성 제안:** 시연을 위한 `admin@microlearn.com` 계정 생성을 위해 `seed.py` 스크립트 개발.
*   **`seed.py` - 상대 경로 임포트 에러 (`ImportError`):**
    *   **원인:** `seed.py` 스크립트 단독 실행 시 `backend` 패키지 내부의 상대 경로 임포트(`from . import models`)를 인식하지 못함.
    *   **해결:** `seed.py`가 `crud.py` 등을 직접 임포트하지 않고, `User Create` 및 비밀번호 해싱 로직을 내부화하도록 스크립트 수정. 또한, `sys.path`에 프로젝트 루트를 추가하고 절대 경로 임포트(`from backend.models import User`)를 사용하도록 변경.
*   **`schemas.py` - Pydantic V2 호환성 에러:**
    *   **원인:** `LearningNote.update_forward_refs(...)`의 Pydantic V2 구문 변경(`TypeError: \`localns\` arguments are not longer accepted.`). `Config: orm_mode = True` 또한 V2에서는 `from_attributes = True`로 변경됨.
    *   **해결:** `schemas.py`에서 `update_forward_refs`를 `model_rebuild()`로 변경하고, `orm_mode = True`를 `from_attributes = True`로 수정.
*   **`auth.py` - `SECRET_KEY` 누락 에러 (`ValueError`):**
    *   **원인:** JWT 서명에 필요한 `SECRET_KEY`가 `.env` 파일에서 제대로 로드되지 않음.
    *   **해결:** `.env` 파일에 `SECRET_KEY`를 추가하고, `uvicorn` 실행 시 `--env-file .env` 옵션을 명시적으로 추가하여 환경 변수 로드 문제 해결. `seed.py`에서도 `load_dotenv()`를 최상단에 추가하여 임포트 전에 로드되도록 수정.
*   **`seed.py` - `no such table: users` 에러:**
    *   **원인:** `seed.py` 실행 시 데이터베이스에 `users` 테이블이 생성되지 않음.
    *   **해결:** `seed.py` 내에서 `Base.metadata.create_all(bind=engine)`을 호출하여 테이블을 명시적으로 생성하도록 수정.
*   **`seed.py` - `bcrypt` 관련 에러 (`AttributeError`):**
    *   **원인:** `passlib`와 `bcrypt` 버전 간의 호환성 문제로 `AttributeError: module 'bcrypt' has no attribute '__about__'` 발생.
    *   **해결:** `auth.py`의 `CryptContext` 해싱 스키마를 `bcrypt`에서 `pbkdf2_sha256`으로 변경하여 우회.
*   **`rag_handler.py` - `ModuleNotFoundError: langchain_community`:**
    *   **원인:** `langchain` 라이브러리 업데이트로 `Chroma` 모듈이 `langchain_community`로 이동했으나, 해당 패키지가 설치되지 않음.
    *   **해결:** `langchain`, `langchain-google-genai`, `langchain-community`, `google-generativeai` 및 관련 의존성 패키지를 `requirements.txt`를 바탕으로 모두 업데이트하여 의존성 충돌 해결.
*   **폼 데이터 처리 에러 (`RuntimeError: Form data requires "python-multipart"`):**
    *   **원인:** FastAPI에서 파일 업로드/폼 데이터 처리에 필요한 `python-multipart` 라이브러리 누락.
    *   **해결:** `python-multipart` 라이브러리 설치 및 `requirements.txt`에 추가.
*   **로그인 "사용자 이름 또는 비밀번호가 잘못되었습니다" 에러:**
    *   `check_user.py` 스크립트를 통해 `admin@microlearn.com` / `admin1234` 계정 정보가 DB에 올바르게 저장 및 검증됨을 확인.
    *   **결론:** 프론트엔드에서 로그인 요청을 보낼 때 `application/x-www-form-urlencoded` 형식을 올바르게 사용하고 있음이 확인됨. 문제는 백엔드 서버가 살아있지 않거나, 다른 이유로 요청 처리에 실패했음을 시사.

### 2.4. 현재 남은 문제: 백엔드 서버 시작 실패
*   **문제:** 백엔드 서버를 포그라운드에서 시작 시 `[WinError 10013]` 에러 발생. `8000번 포트`가 사용 중이거나 접근이 차단된 것으로 추정됨.
*   **향후 계획:** 포트 충돌 문제 해결 또는 다른 포트(예: `8001`) 사용 고려.
