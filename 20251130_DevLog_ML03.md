# MicroLearn AI 개발 로그 - 2025년 11월 30일 (ML03)

**작성자:** Claude Code Agent
**작업 일시:** 2025년 11월 30일
**이전 작업:** MicroLearn_AI_개발_7회차_보고서 (2025년 11월 24일)

---

## 1. 작업 개요

- **목표:** 시연용 Portable 패키지 빌드 및 배포 준비
- **작업 시간:** 약 2시간
- **주요 성과:** Release 폴더 완성, 프론트엔드 빌드 완료, 실행 스크립트 작성

---

## 2. 완료된 작업

### 2.1 기술 스택 정리

프로젝트의 전체 기술 스택을 문서화:

**프론트엔드:**
- React 19.1.1 + TypeScript 4.9.5
- Zustand 5.0.8 (상태 관리)
- React Router DOM 7.9.3
- Mermaid 11.12.0 (마인드맵 시각화)

**백엔드:**
- FastAPI 0.118.0 + Uvicorn 0.37.0
- SQLAlchemy 2.0.43 (ORM)
- Python-JOSE 3.5.0, BCrypt 5.0.0 (인증)

**AI/ML & RAG:**
- Google Generative AI (Gemini 1.5 Flash)
- LangChain + LangChain-Google-GenAI
- ChromaDB (벡터 데이터베이스)
- Tiktoken (토큰화)

**문서 처리:**
- PyPDF, Python-DOCX
- Trafilatura (웹 스크래핑)
- YouTube-Transcript-API

### 2.2 백엔드 수정 (backend/main.py)

프론트엔드를 백엔드에서 직접 서빙하도록 수정:

1. **프론트엔드 정적 파일 서빙 추가** (라인 38-42)
   ```python
   frontend_build_path = Path(__file__).parent.parent / "frontend" / "build"
   if frontend_build_path.exists():
       app.mount("/assets", StaticFiles(directory=frontend_build_path / "assets"), name="assets")
   ```

2. **CORS 설정 업데이트** (라인 44-56)
   - `http://localhost:8000` 추가 (프로덕션 모드)

3. **SPA Fallback 처리** (라인 467-488)
   - 루트 경로(`/`)에서 `index.html` 서빙
   - 모든 비-API 경로를 `index.html`로 라우팅

### 2.3 Release 폴더 구조 생성

시연용 Portable 패키지 구조:

```
Release/                    # 15MB, 107개 파일
├── backend/
│   ├── *.py               # 백엔드 소스 파일
│   ├── requirements.txt   # 패키지 의존성
│   ├── .env               # API 키 설정
│   ├── sql_app.db         # 시연용 데이터베이스
│   └── static/            # TTS 오디오 파일
├── frontend/
│   └── build/             # 프론트엔드 빌드 파일 (242KB gzipped)
│       ├── index.html
│       └── static/
├── setup.bat              # 초기 설정 스크립트
├── MicroLearn.bat         # 실행 스크립트
└── 시연가이드.txt          # 사용 가이드
```

### 2.4 배치 스크립트 작성

#### setup.bat
- Python 가상환경 생성
- 패키지 자동 설치
- 초기 설정 완료 확인

#### MicroLearn.bat
- 가상환경 자동 활성화
- Uvicorn 서버 자동 시작 (포트 8000)
- 브라우저 자동 열기 (http://localhost:8000)

**중요:** UTF-8 인코딩 활성화 (`chcp 65001`) 및 영어로 작성하여 한글 깨짐 방지

### 2.5 문서 작성

#### 시연가이드.txt (Release 폴더 내)
- 시스템 요구사항
- 빌드 준비 방법
- 강의장 PC 실행 방법
- 10분 시연 시나리오
- 문제 해결 가이드

#### 빌드가이드.md (프로젝트 루트)
- 전체 빌드 프로세스 설명
- 프론트엔드 빌드 방법
- Release 폴더 구조
- 배포 준비 사항

### 2.6 프론트엔드 빌드

```bash
cd frontend
npm run build
```

**빌드 결과:**
- 메인 JS: 242.03 kB (gzipped)
- 총 43개 청크 파일 생성
- CSS: 1.18 kB
- 빌드 성공 및 Release 폴더로 복사 완료

---

## 3. 발생한 오류 및 해결 방법

### 3.1 배치 파일 한글 인코딩 문제

**문제:**
```
'backend'은(는) 내부 또는 외부 명령, 실행할 수 있는 프로그램, 또는 배치 파일이 아닙니다.
'?꾩슂?⑸땲??'은(는) 내부 또는 외부 명령...
```

**원인:** Windows 배치 파일에서 한글이 깨져서 명령어로 인식됨

**해결:**
1. `chcp 65001` 추가 (UTF-8 인코딩 활성화)
2. 모든 메시지를 영어로 변경
3. setup.bat 및 MicroLearn.bat 재작성

**파일 위치:**
- `Release/setup.bat:2`
- `Release/MicroLearn.bat:2`

### 3.2 FastAPI 미설치 오류

**문제:**
```
ModuleNotFoundError: No module named 'fastapi'
```

**원인:** setup.bat이 패키지 설치를 완료하지 못함 (사용자가 중간에 중단했거나 에러 무시)

**해결:**
```cmd
cd Release\backend
venv\Scripts\activate
pip install -r requirements.txt
```

**재발 방지:** setup.bat을 끝까지 실행하여 "Setup completed successfully!" 메시지 확인 필요

### 3.3 lxml_html_clean 모듈 오류

**문제:**
```
ImportError: lxml.html.clean module is now a separate project lxml_html_clean.
Install lxml[html_clean] or lxml_html_clean directly.
```

**원인:** lxml 최신 버전(6.0.2)에서 html.clean 모듈이 별도 패키지로 분리됨

**해결:**
1. 즉시 해결:
   ```cmd
   pip install lxml_html_clean
   ```

2. requirements.txt 업데이트:
   ```
   lxml==6.0.2
   lxml_html_clean    # 추가
   passlib==1.7.4
   ```

**파일 수정:**
- `backend/requirements.txt:27`
- `Release/backend/requirements.txt:27`

---

## 4. 테스트 및 검증

### 4.1 로컬 테스트 수행

1. ✓ setup.bat 실행 - 가상환경 생성 및 패키지 설치
2. ✓ lxml_html_clean 추가 설치
3. ⏳ MicroLearn.bat 실행 - 서버 시작 (진행 중)
4. ⏳ 브라우저 접속 테스트 (대기 중)

### 4.2 빌드 결과

- **Release 폴더 크기:** 15MB
- **총 파일 수:** 107개
- **프론트엔드 빌드:** 성공 (242KB gzipped)
- **백엔드 파일 복사:** 완료
- **실행 스크립트:** 작성 완료

---

## 5. 앞으로 할 일

### 5.1 즉시 처리 (오늘/내일)

- [ ] **서버 정상 작동 확인**
  - MicroLearn.bat 실행
  - http://localhost:8000 접속 확인
  - 모든 기능 정상 작동 테스트

- [ ] **시연 리허설**
  - 회원가입/로그인
  - 학습 노트 생성
  - 파일/URL/YouTube 업로드
  - AI 자료 생성 확인
  - RAG 대화 기능 테스트
  - TTS, 퀴즈, 마인드맵 확인

### 5.2 USB 배포 준비

- [ ] **Release 폴더를 USB에 복사**
  - 전체 폴더 복사 (15MB)
  - 다른 PC에서 테스트
  - setup.bat 및 MicroLearn.bat 실행 확인

- [ ] **.env 파일 확인**
  - GEMINI_API_KEY 유효성 확인
  - SECRET_KEY 설정 확인

- [ ] **시연용 계정 준비**
  - admin@microlearn.com 비밀번호 확인
  - 또는 새 계정 생성 준비

### 5.3 시연 준비 (발표 전)

- [ ] **10분 시연 시나리오 숙지**
  - 00:00-01:00: 소개 및 시작
  - 01:00-02:30: 회원가입/로그인
  - 02:30-04:00: 학습 노트 생성
  - 04:00-06:30: AI 자료 생성
  - 06:30-08:30: RAG 대화 기능
  - 08:30-09:30: 추가 기능
  - 09:30-10:00: 마무리 Q&A

- [ ] **강의장 PC 환경 확인**
  - Python 설치 여부
  - 인터넷 연결 (패키지 설치용)
  - 웹 브라우저 종류

- [ ] **백업 계획 수립**
  - 포트 8000 충돌 시 → 포트 변경 (8001)
  - 인터넷 연결 불가 시 → 사전 패키지 설치
  - Python 미설치 시 → PyInstaller exe 버전 준비 (선택)

### 5.4 문서 정리 (발표 후)

- [ ] **최종 보고서 작성**
  - 프로젝트 완료 보고서
  - 기능 구현 완료도
  - 기술적 성과 및 한계

- [ ] **코드 정리**
  - 불필요한 주석 제거
  - 사용하지 않는 코드 삭제
  - 코드 스타일 통일

---

## 6. 기술적 세부 사항

### 6.1 Portable 패키지 구조

**장점:**
- Python이 설치된 환경에서 즉시 실행 가능
- 모든 의존성이 가상환경에 포함됨
- USB/외장하드에서 직접 실행 가능
- 설치 불필요 (setup.bat 1회만)

**단점:**
- Python 설치 필수
- 첫 실행 시 패키지 설치 필요 (3-5분)
- 인터넷 연결 필요 (초기 설정 시)

### 6.2 백엔드-프론트엔드 통합

기존 구조 (개발 환경):
- 프론트엔드: localhost:3000 (React 개발 서버)
- 백엔드: localhost:8000 (FastAPI)
- CORS를 통한 통신

새 구조 (프로덕션/시연):
- 단일 서버: localhost:8000
- 백엔드가 프론트엔드 빌드 파일을 서빙
- SPA fallback으로 모든 라우트 처리

### 6.3 배치 파일 설계

**setup.bat:**
```batch
chcp 65001          # UTF-8 인코딩
python -m venv venv # 가상환경 생성
pip install -r requirements.txt  # 패키지 설치
```

**MicroLearn.bat:**
```batch
chcp 65001          # UTF-8 인코딩
venv\Scripts\activate  # 가상환경 활성화
start http://localhost:8000  # 브라우저 자동 열기
python -m uvicorn main:app --host 0.0.0.0 --port 8000  # 서버 시작
```

---

## 7. 참고 자료

### 7.1 관련 파일

- `빌드가이드.md` - 전체 빌드 프로세스
- `Release/시연가이드.txt` - 사용 방법 및 시연 시나리오
- `MicroLearn_AI_개발_7회차_보고서.md` - 이전 작업 내역

### 7.2 포트 문제 해결 (7회차 보고서 참조)

**8000번 포트 사용 불가 시:**
```batch
# MicroLearn.bat 수정
python -m uvicorn main:app --host 0.0.0.0 --port 8001
```

브라우저: http://localhost:8001

### 7.3 시연용 계정

- **이메일:** admin@microlearn.com
- **비밀번호:** (6회차 보고서 참조)
- **생성일:** 2025년 11월 10일

---

## 8. 다음 개발 세션 전 확인 사항

1. Release 폴더가 USB에 복사되었는가?
2. 강의장 PC에서 테스트를 완료했는가?
3. 모든 기능이 정상 작동하는가?
4. 시연 시나리오를 숙지했는가?
5. 백업 계획이 수립되었는가?

---

**다음 작업 예정:** 강의장 PC 테스트 및 시연 리허설
**예상 소요 시간:** 1-2시간
**우선순위:** 높음 (발표 준비)

---

## 변경 이력

- 2025-11-30: 최초 작성 (ML03)
- 백엔드 main.py 수정 (프론트엔드 서빙)
- Release 폴더 구조 생성
- 배치 스크립트 작성 및 오류 수정
- 프론트엔드 빌드 완료
- requirements.txt 업데이트 (lxml_html_clean 추가)
